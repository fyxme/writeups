import cProfile

def exploit():
    #fp = "pico2018-special-logo.bmp"
    #check_word = "pico"
    fp = "/Users/louis/Downloads/10a9wks.png"
    check_word = "OWEEK"

    #fp = "/Users/louis/Downloads/ufo.jpeg"
    #check_word = "glug"

    with open(fp) as f:
        data = f.read()

    lsb = map(lambda x: bin(ord(x))[-1], data)

    for base in range(len(lsb)):
        chunks = [lsb[base+j:base+j+8] for j in range(0, len(lsb), 8)]

        if len(chunks[-1]) != 8:
            chunks = chunks[:-1]


        chunks = map(lambda x: chr(int("".join(x),2)), chunks)
        word = "".join(chunks)

        if check_word in word:
            print word
            exit()

def main():
    exploit()
    #cProfile.runctx("exploit()",globals(), locals(), filename=None, sort="time")

if __name__ == '__main__':
    main()
