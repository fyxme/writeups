#include <stdio.h>

int global_canary;

int check_canary(char test_canary) {
    // 24
    if (strncmp(test_canary, global_canary, 8) == 0){
        printf("Canary is legit.\n");
    } else {
        // Canary %.8s modified from global canary %s
        printf("Canary %.8s modified from global canary %s\n", test_canary, global_canary);
        abort();
    }
    return 0;
}

int main(int argc, char const *argv[]) {
    int canary;
    char buffer[];

    setbuf(STDOUT, NULL); // -4

    fh = fopen("/dev/urandom", "r")

    fread(global_canary, 1, 8, fh); //

    fclose(fh);

    strncpy(canary, global_canary, 8);

    puts("Enter as:");

    fread(buffer, 1, 16 STDIN);

    /* STUFF HAPPENS HERE */
    // copying the buffer to buffer + 32


    printf("This is the 9447 wargaming gateway, %s!\n",);
    printf("Write your data to the buffer[%p].\n",);

    gets(buffer);

    check_canary(canary);

    puts("Data saved!\n");

    return 0;
}

// Global canary value: 0x0804a085

// `info variables`
    // find global_canary
// `x/10x 0x0804a085`
    // global_canary value: 0x9264acb3 0x5597134f

// the canary is being displayed on the terminal
