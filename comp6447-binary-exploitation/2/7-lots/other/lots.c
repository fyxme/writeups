#include <stdio.h>

void win(/* arguments */) {
    system("/bin/sh");
}

int main(int argc, char const *argv[]) {
    // sub 528
    char var_D[4] = "9447";
    var_20D = ;
    var_9 = ;

    char *esp_16
    char *esp_48
    char *eax;

    eax = &esp_16-esp_20
    esp_48 = eax
    fread(buffer, 1, 16, STDIN);


    arg_1 = *esp_48
    arg_0 = "This is the %s\n"
    printf(arg_0, arg_1);

    printf("This is the %s\n", &esp_48);
    printf("Write your data to [%p]\n", esp_16);

    gets(esp_16);

    setbuf(STDOUT, 0);

    printf("A door blocks your path at %p\n", var_D);
    printf("The value '%s' appears in magical letters on it.\n", var_D);

    printf("Speak friend and enter: ");

    scanf("%s", var_20D);

    printf("\nYou say, \"");
    printf(var_20D); // VULNERABLE
    puts("\"\n");

    puts("The magical letters begin to shimmer and morph");

    printf("After a while they reform again as '%s'\n", var_D);

    if (strncmp("FRND", var_D, 4) == 0)
        win();
    else
        puts("This doesn't satisfy the door so it ignores you.");

    return 0;
}
